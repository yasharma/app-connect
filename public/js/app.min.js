"use strict";angular.module("bharatConnect",["ngRoute","ngMessages","toaster","ngAnimate","angular-loading-bar","app.controllers","app.factories","app.directives","LocalStorageModule"]).config(["$routeProvider","cfpLoadingBarProvider",function(e,r){r.includeSpinner=!1,e.when("/",{controller:"authCtrl",templateUrl:"app/views/login.html",access:{requiredLogin:!1}}).when("/register",{controller:"authCtrl",templateUrl:"app/views/register.html",access:{requiredLogin:!1}}).when("/shop",{controller:"shopCtrl",templateUrl:"app/views/shop.html",access:{requiredLogin:!0}}).otherwise({redirectTo:"/"})}]).run(["$location","$rootScope","localStorageService",function(e,r,t){r.$on("$routeChangeStart",function(r,n,o){null!==n&&null!==n.access&&n.access.requiredLogin&&!t.get("user")&&e.path("/")}),r.logout=function(){t.remove("user"),delete r.user,e.path("/")},r.user=t.get("user")}]),angular.module("app.controllers",[]),angular.module("app.factories",[]),angular.module("app.directives",[]),angular.module("app.factories").factory("RestSvr",["$http",function(e){return{login:function(r,t){return e.post(r,t).then(function(e){return{result:e.data.success,user:e.data.user,token:e.data.token}},function(e){return{errors:e.data.errors}})},paginate:function(r,t,n){var o=angular.isUndefined(t)?"":t;angular.isUndefined(n)?"":n;return e.get(r,o).then(function(e){return{records:e.data.records,paging:e.data.paging}})},get:function(r,t){angular.isUndefined(t)?null:t;return e.get(r,t).then(function(e){return{records:e.data.records}})},getById:function(r,t){return e.get(r+t).then(function(e){return{record:e.data}})},post:function(r,t){return e.post(r,t).then(function(e){return{result:e.data.success,message:e.data.message,data:e.data.user}},function(e){return{errors:e.data.errors}})},put:function(r,t,n){return e.put(r+t,n).then(function(e){return{result:e.data.success,message:e.data.message,data:e.data.user}},function(e){return{errors:e.data.errors}})},delete:function(r,t){return e.delete(r+t).then(function(e){return{message:e.data.message,result:e.data.result}})}}}]),angular.module("app.directives").directive("navMenu",["$location",function(e){return function(r,t,n){for(var o=t.find("a"),a={},s=n.navMenu||"active",u=o.length-1;u>=0;u--){var i=angular.element(o[u]),c=angular.isUndefined(i.attr("href"))?i.attr("ng-href"):i.attr("href");"#"===c.substring(0,1)?a[c.substring(1)]=i:a[c]=i}r.$on("$routeChangeStart",function(){var r=a[e.path()];o.parent("li").removeClass(s),r&&r.parent("li").addClass(s)})}}]),angular.module("app.controllers").controller("authCtrl",["$scope","RestSvr","toaster","$location","localStorageService","$rootScope",function(e,r,t,n,o,a){e.register=function(o){o&&r.post("/register",e.user).then(function(e){e.errors?t.pop({type:"error",title:"Error",body:e.errors.email.message,showCloseButton:!0}):(n.path("/"),t.pop({type:"success",title:"Success",body:"Registration successful, you can now login ",showCloseButton:!0}))})},e.login=function(s){s&&r.post("/login",e.user).then(function(e){e.errors?t.pop({type:"error",title:"Error",body:e.errors.message,showCloseButton:!0}):(o.set("user",e.data),a.user=o.get("user"),n.path("/shop"))})}}]),angular.module("app.controllers").controller("shopCtrl",["$scope","RestSvr","toaster","$location","localStorageService","$rootScope",function(e,r,t,n,o,a){r.get("/pets").then(function(r){r.records&&(e.pets=r.records)}),e.buy=function(t){var n,a;n=e.pets[t],a=o.get("user"),r.put("/update/",a._id,{petId:n._id},function(e){console.log(e)})}}]);